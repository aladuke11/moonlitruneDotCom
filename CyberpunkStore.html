<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyberpunk Store</title>
    <link rel="stylesheet" href="styles.css?v=2">
    <link rel="stylesheet" href="cyberpunkstore.css?v=2">
</head>
<body>
    <header>
        <div class="title-box">
            <h1>Cyberpunk Store</h1>
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="projects.html">Projects</a></li>
            </ul>
        </nav>
    </header>
    <main class="store-main">
        <div class="storeheading">
            <h2>Welcome to the Cyberpunk Store</h2>
            <p>Your one-stop shop for all things cyberpunk! Explore our collection of futuristic gadgets, neon apparel, and dystopian accessories.</p>
        </div>
        <section class="productGrid">
            <div class="productCard">
                <img class="productImage" src="images/8adfe9eb-0b2c-433d-9c08-f97a0f494f1a.png" alt="Cyberpunk Jacket">
                <h3 class="productTitle">Neon Cyber Jacket</h3>
                <p class="productDescription">Stay stylish and illuminated with our Neon Cyber Jacket, featuring LED accents and a sleek design.</p>
                <span class="productPrice">$149.99</span>
                <button class="buyButton">Buy Now</button>
             </div>
                <div class="productCard soldOut">
                    <img class="productImage" src="images/8adfe9eb-0b2c-433d-9c08-f97a0f494f1a.png" alt="Cyberpunk Goggles">
                    <div class="soldOutBadge">SOLD OUT</div>
                    <h3 class="productTitle">HoloVision Goggles</h3>
                    <p class="productDescription">Experience augmented reality like never before with our HoloVision Goggles, perfect for gaming and navigation.</p>
                    <span class="productPrice">$89.99</span>
                    <button class="buyButton" disabled>Unavailable</button>
                </div>
                <div class="productCard">
                    <img class="productImage" src="images/8adfe9eb-0b2c-433d-9c08-f97a0f494f1a.png" alt="Cyberpunk Wristband">
                    <h3 class="productTitle">NeuroLink Wristband</h3>
                    <p class="productDescription">Enhance your cognitive functions with the NeuroLink Wristband, featuring brainwave synchronization technology.</p>
                    <span class="productPrice">$199.99</span>
                    <button class="buyButton">Buy Now</button>
                </div>
                <div class="productCard">
                    <img class="productImage" src="images/8adfe9eb-0b2c-433d-9c08-f97a0f494f1a.png" alt="Cyberpunk Backpack">
                    <h3 class="productTitle">TechRunner Backpack</h3>
                    <p class="productDescription">Carry your gear in style with the TechRunner Backpack, equipped with solar charging panels and anti-theft features.</p>
                    <span class="productPrice">$129.99</span>
                    <button class="buyButton">Buy Now</button>
                </div>
        
        </section>
        <div id="hiddenBox" class="hidden-box" style="display: none;">
            <div class="hidden-content">
                <h2>‚ö†Ô∏è WARNING ‚ö†Ô∏è</h2>
                <p>By equipping the HoloVision Goggles, you have gained access to restricted systems.</p>
                <div class="holo-message">
                    <p><strong>ENCRYPTED TRANSMISSION DETECTED</strong></p>
                    <p>Your augmented reality layer has detected an anomalous signal in the cybernetic fabric of the city.</p>
                    <p>Unknown faction attempting contact...</p>
                    <p style="color: var(--color-neon-green); text-shadow: 0 0 10px var(--color-neon-green); margin-top: 20px;">
                        "Welcome, operative. Your credentials have been verified. The goggles you now wear grant you access to classified information. The network awaits your next move..."
                    </p>
                </div>
                <button id="closeHidden" class="close-hidden-btn">Close Access</button>
            </div>
        </div>
        <div class="full-screen-popup">
            <div class="popup-content">
                <span class="close-popup">&times;</span>
                <h2>Credits Low</h2>
                <p>Your account lacks credits. Would you like to borrow some more?</p>
                <p class="disclamer">Warning failure to pay will result in account suspension. Agreeing to this nulls your rights to defend yourself In the event Crypto corp hunts you down.</p>
                <button class="confirm-button">Agree</button>
                <button class="cancel-button">Cancel</button>
            </div>
        </div>
    
        
    </main>
    <footer>
        <p>&copy; 2024 Cyberpunk Store</p>
    </footer>
    
    <script>
        // Credit debt tracking
        const DEBT_KEY = 'cryptoCorp_debt';
        const PURCHASES_KEY = 'cryptoCorp_purchases';
        const GOGGLES_UNLOCK_KEY = 'cryptoCorp_gogglesUnlocked';
        
        function saveDebt(amount) {
            const currentDebt = parseFloat(localStorage.getItem(DEBT_KEY)) || 0;
            const newDebt = currentDebt + amount;
            localStorage.setItem(DEBT_KEY, newDebt.toFixed(2));
            return newDebt;
        }

        function getDebt() {
            return parseFloat(localStorage.getItem(DEBT_KEY)) || 0;
        }

        function clearDebt() {
            localStorage.removeItem(DEBT_KEY);
        }

        // Purchase tracking
        function savePurchase(itemName, price) {
            const purchases = JSON.parse(localStorage.getItem(PURCHASES_KEY)) || [];
            purchases.push({
                name: itemName,
                price: price,
                date: new Date().toLocaleString()
            });
            localStorage.setItem(PURCHASES_KEY, JSON.stringify(purchases));
            return purchases.length;
        }

        function getPurchases() {
            return JSON.parse(localStorage.getItem(PURCHASES_KEY)) || [];
        }

        function clearPurchases() {
            localStorage.removeItem(PURCHASES_KEY);
        }

        // Popup functionality
        const popup = document.querySelector('.full-screen-popup');
        const closeBtn = document.querySelector('.close-popup');
        const confirmBtn = document.querySelector('.confirm-button');
        const cancelBtn = document.querySelector('.cancel-button');
        const buyButtons = document.querySelectorAll('.buyButton:not(:disabled)');

        let currentItem = null; // Store the item being purchased

        // Close popup function
        function closePopup() {
            popup.classList.remove('active');
            currentItem = null;
        }

        // Open popup function
        function openPopup(itemName, price) {
            currentItem = { name: itemName, price: price };
            popup.classList.add('active');
        }

        // Event listeners for popup controls
        closeBtn.addEventListener('click', closePopup);
        cancelBtn.addEventListener('click', closePopup);
        
        confirmBtn.addEventListener('click', function() {
            const debt = saveDebt(500); // Add $500 debt on agreement
            if (currentItem) {
                savePurchase(currentItem.name, currentItem.price);
                alert(`Purchase recorded!\nItem: ${currentItem.name}\nPrice: $${currentItem.price}\n\nTotal Debt: $${debt.toFixed(2)}`);
                
                // Check if goggles were just purchased
                if (currentItem.name.includes('HoloVision Goggles')) {
                    setTimeout(() => {
                        showHiddenBox();
                    }, 500);
                }
            } else {
                alert(`Credits borrowed successfully! Your debt has been recorded.\n\nTotal Debt: $${debt.toFixed(2)}`);
            }
            closePopup();
        });

        // Add click listeners to all buy buttons
        buyButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                const productCard = button.closest('.productCard');
                const itemName = productCard.querySelector('.productTitle').textContent;
                const itemPrice = productCard.querySelector('.productPrice').textContent.replace('$', '');
                openPopup(itemName, itemPrice);
            });
        });

        // Close popup when clicking outside of it
        popup.addEventListener('click', function(e) {
            if (e.target === popup) {
                closePopup();
            }
        });

        // Hidden box functionality
        const hiddenBox = document.getElementById('hiddenBox');
        const closeHiddenBtn = document.getElementById('closeHidden');

        function showHiddenBox() {
            hiddenBox.style.display = 'flex';
            localStorage.setItem('goggles_purchased', 'true');
        }

        function hideHiddenBox() {
            hiddenBox.style.display = 'none';
        }

        closeHiddenBtn.addEventListener('click', hideHiddenBox);
        hiddenBox.addEventListener('click', function(e) {
            if (e.target === hiddenBox) {
                hideHiddenBox();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && hiddenBox.style.display === 'flex') {
                hideHiddenBox();
            }
        });

        // Check for existing debt and unlock status on page load
        window.addEventListener('load', function() {
            const debt = getDebt();
            if (debt > 0) {
                console.log(`‚ö†Ô∏è Existing debt detected: $${debt.toFixed(2)}`);
            }
            
            const purchases = getPurchases();
            if (purchases.length > 0) {
                console.log(`üì¶ Purchase History (${purchases.length} items):`);
                purchases.forEach((purchase, index) => {
                    console.log(`  ${index + 1}. ${purchase.name} - $${purchase.price} (${purchase.date})`);
                    
                    // Check if goggles were previously purchased
                    if (purchase.name.includes('HoloVision Goggles') && localStorage.getItem('goggles_purchased') === 'true') {
                        // Don't auto-show on reload - user can interact to view
                    }
                });
            }

            // Check if goggles are unlocked and update UI
            const isUnlocked = localStorage.getItem(GOGGLES_UNLOCK_KEY) === 'true';
            if (isUnlocked) {
                const gogglesCard = document.querySelector('.productCard.soldOut');
                if (gogglesCard) {
                    gogglesCard.classList.remove('soldOut');
                    const badge = gogglesCard.querySelector('.soldOutBadge');
                    if (badge) badge.remove();
                    const button = gogglesCard.querySelector('.buyButton');
                    if (button) {
                        button.disabled = false;
                        button.textContent = 'Buy Now';
                        // Re-attach event listener for newly enabled button
                        button.addEventListener('click', function(e) {
                            e.preventDefault();
                            const productCard = button.closest('.productCard');
                            const itemName = productCard.querySelector('.productTitle').textContent;
                            const itemPrice = productCard.querySelector('.productPrice').textContent.replace('$', '');
                            openPopup(itemName, itemPrice);
                        });
                    }
                    console.log('üîì HoloVision Goggles unlocked!');
                }
            }

            // Show hidden box if goggles were previously purchased
            const gogglesPurchased = localStorage.getItem('goggles_purchased') === 'true';
            if (gogglesPurchased && purchases.some(p => p.name.includes('HoloVision Goggles'))) {
                const banner = document.createElement('div');
                banner.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--color-neon-green);
                    color: var(--color-background);
                    padding: 15px 20px;
                    border-radius: 5px;
                    z-index: 999;
                    font-weight: bold;
                    cursor: pointer;
                    box-shadow: 0 0 10px var(--color-neon-green);
                `;
                banner.textContent = 'üëÅÔ∏è Click to access hidden content';
                banner.addEventListener('click', showHiddenBox);
                document.body.appendChild(banner);
            }
        });

        // Optional: Add keyboard support (ESC to close)
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && popup.classList.contains('active')) {
                closePopup();
            }
        });
    </script>
</body>
</html>